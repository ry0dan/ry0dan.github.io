---
title: "Snake Keylogger in depth analysis"
classes: wide
header:
  teaser:  /assets/images/kovter-unpacking.jpg
ribbon: red
description: "In depth analysis of Snake Keylogger"
categories:
  - Malware Analysis
  - Unpacking
tags:
  - Keylogger
  - Unpacking
  - .NET
toc: true
---
Sample:
```
75e9490ebc271316e8ce7a19e8a4289173980d8368054006c75dd9eb27503737
```

# Initial Assesment

![Screenshot1](/assets/images/malware-analysis/snake/snakekeylogger1.png)

looking at the resource we see that there is an executable.
![Screenshot2](/assets/images/malware-analysis/snake/snakekeylogger2.png)

also if we disassembled with IDA we'll see that it starts by queriying the resource in order to drop and execute it.

![Screenshot2](/assets/images/malware-analysis/snake/snakekeylogger3.png)

using CFF explorer let's dump it and have a look at it.
![Screenshot2](/assets/images/malware-analysis/snake/snakekeylogger4.png)

# Analysis of executable in resource

At initial assesment with pestudio we see that it has a .NET stream, so we can use DnSpy to open the executable.
![Screenshot2](/assets/images/malware-analysis/snake/snakekeylogger6.png)

as we see, the code is highly obfuscated, and we can't work on it like this, instead we can use de4dot tool to deobfuscate and then analyse the sample.
![Screenshot2](/assets/images/malware-analysis/snake/snakekeylogger7.png)

now let's start analysing the functions called in the beginning of main, one by one, note that there are a couple of empty functions.
![Screenshot8](/assets/images/malware-analysis/snake/snakekeylogger8.png)

here we see that this method is calling smethod_0 which all what it does is to detect chrom process and kill it, the same in smethod_69 it calls smethod_1 which kills firefox.
 ![Screenshot8](/assets/images/malware-analysis/snake/snakekeylogger9.png)
 ![Screenshot8](/assets/images/malware-analysis/snake/snakekeylogger10.png)
 ![Screenshot8](/assets/images/malware-analysis/snake/snakekeylogger11.png)














